简介
^^^^^^^

HI，您好，欢迎使用高重AI开放平台定额发票OCR API接口服务。

| 本文档主要针对需要集成HTTP API的技术研发工程师，详细描述定额发票OCR能力相关的技术内容。

接口能力
^^^^^^^^^
============ ========================= =======================================================
  接口名称    		接口描述       							API地址
============ ========================= =======================================================
 定额发票OCR      识别发票上的字段信息       https://openai.grandhonor.net/api/invoice/ocr
============ ========================= =======================================================
*|更多更强大的接口能力正在开发中，并逐步开放，敬请期待！*

协议须知
^^^^^^^^^
调用方集成通用OCR API时，请遵循以下规则。

============ ========================= 
   规则    		    描述       	
============ ========================= 
  传输方式       HTTP    
  请求方法       POST   
  字符编码      统一采用UTF-8编码   
  响应格式      统一采用JSON格式   
  接口鉴权    签名机制，详情请阅接口鉴权    
============ ========================= 

发票识别接口
^^^^^^^^^^^^

**1.接口描述**

| 根据用户上传的发票，返回识别出的字段信息。

**2. 请求参数**

+----------+---------+----------+-------------------------+----------+------------------+   
|参数名称  | 是否必选| 数据类型 | 数据约束                | 示例数据 |  描述            |
+==========+=========+==========+=========================+==========+==================+   
| app_id   |  是     | int      |   正整数                | 10001    |应用标识（AppId） |
+----------+---------+----------+-------------------------+----------+------------------+  
|time_stamp|  是     | int      |   正整数                |          |请求时间戳（秒级）|
+----------+---------+----------+-------------------------+----------+------------------+ 
|nonce_str |  是     | string   | 非空且长度上限32字节    | fa577c   |	随机字符串    |
+----------+---------+----------+-------------------------+----------+------------------+  
| sign     |  是     | string   | 非空且长度上限32字节    |          |签名信息，详      |
|          |         |          |                         |          |见接口鉴权）      |
+----------+---------+----------+-------------------------+----------+------------------+  
| image    |  是     | string   |原始图片的base64编码数据 |          |待识别图片        |
|          |         |          |（原图大小上限1MB，支持  |   ...    |                  |
|          |         |          |                         |          |                  |
|          |         |          |    JPG、PNG、BMP格式）  |          |                  |
+----------+---------+----------+-------------------------+----------+------------------+     
       
**3. 响应参数**

+----------+---------+----------+-------------------------------------------+   
|参数名称  | 是否必选| 数据类型 |   描述                                    |
+==========+=========+==========+===========================================+   
| ret      |  是     | int      |   正整数                                  |
+----------+---------+----------+-------------------------------------------+  
|msg       |  是     | int      |   正整数                                  |
+----------+---------+----------+-------------------------------------------+ 
|data      |  是     | string   | 非空且长度上限32字节                      |
+----------+---------+----------+-------------------------------------------+  
|item_list |  是     | string   | 非空且长度上限32字节                      |
|          |         |          |                                           |
+----------+---------+----------+-------------------------------------------+  
|  item    |  是     | string   |原始图片的base64编码数据                   |
|          |         |          |（原图大小上限1MB，支持                    |
|          |         |          |                                           |
+----------+---------+----------+-------------------------------------------+ 
|itemstring|  是     | string   | 非空且长度上限32字节                      |
+----------+---------+----------+-------------------------------------------+  


**4. 请求限制**

============ ==================== ==========================
  未认证用户    个人认证用户        企业认证用户
============ ==================== ==========================
     1              2                            10
============ ==================== ==========================


**5. 参考示例**

假设示例请求数据如下。具体调用方式见SDK及文档。

============ ==================== ==========================
  参数名称     参数数据              描述
============ ==================== ==========================
  app_id	       1000001	           仅供参考
  image		                           实时计算base64
  time_st	                           实时计算
  nonce_str		                       实时计算
  sign		                           实时计算   
============ ==================== ==========================


假设应用密钥为：bhiOaZRznGjFROtk，示例图片文件存储路径为：/path/to/image。

| 下面使用PHP实现该HTTP API调用，其中getReqSign、doHttpPost可以从`接口鉴权获取`_。

.. _接口鉴权获取: https://aiopendoc.readthedocs.io/en/latest/guide.html#id7

.. code-block:: c                                               
  :linenos:                                                   
  :emphasize-lines: 1,6,17

  // 图片base64编码
  $path   = '/path/to/image';
  $data   = file_get_contents($path);
  $base64 = base64_encode($data);

  // 设置请求数据
  $appkey = 'bhiOaZRznGjFROtk';
  $params = array(
      'app_id'     => '1000001',
      'image'      => $base64,
      'time_stamp' => strval(time()),
      'nonce_str'  => strval(rand()),
      'sign'       => '',
  );
  $params['sign'] = getReqSign($params, $appkey);

  // 执行API调用
  $url = 'https://openai.grandhonor.net/Main/Index';
  $response = doHttpPost($url, $params);
  echo $response;


source code below :: 

    // 图片base64编码
    $path   = '/path/to/image';
    $data   = file_get_contents($path);
    $base64 = base64_encode($data);

    // 设置请求数据
    $appkey = ''bhiOaZRznGjFROtk'';
    $params = array(
        'app_id'     => '1000001',
        'image'      => $base64,
        'time_stamp' => strval(time()),
        'nonce_str'  => strval(rand()),
        'sign'       => '',
    );
    $params['sign'] = getReqSign($params, $appkey);

    // 执行API调用
    $url = 'https://openai.grandhonor.net/Main/Index';
    $response = doHttpPost($url, $params);
    echo $response;

