**简介**
^^^^^^^^^^

本文档主要针对需要集成HTTP API的技术研发工程师。

| 高重AI开放平台HTTP API使用签名机制对每个接口请求进行权限校验，对于校验不通过的请求，API将拒绝处理，并返回鉴权失败错误。

| 接口调用者在调用API时必须带上接口请求签名，其中签名信息由接口`请求参数`和`应用密钥`根据本文提供的签名算法生成。

| 本文档提供 getReqSign（计算签名） 、doHttpPost（执行HTTP POST调用）两个PHP实现的工具函数方便开发者参考。

**签名算法**
^^^^^^^^^^^^^^

**1. 计算步骤**

用于计算签名的参数在不同接口之间会有差异，但算法过程固定如下4个步骤。

    | 1. 将<key, value>请求参数对按key进行字典升序排序，得到有序的参数对列表N
    | 2. 将列表N中的参数对按URL键值对的格式拼接成字符串，得到字符串T（如：key1=value1&key2=value2），URL键值拼接过程value部分需要URL编码，URL编码算法用大写字母，例如%E8，而不是小写%e8
    | 3. 将应用密钥以app_key为键名，组成URL键值拼接到字符串T末尾，得到字符串S（如：key1=value1&key2=value2&app_key=密钥)
    | 4. 对字符串S进行MD5运算，将得到的MD5值所有字符转换成大写，得到接口请求签名


**2. 注意事项**

- 不同接口要求的参数对不一样，计算签名使用的参数对也不一样

- 参数名区分大小写，参数值为空不参与签名

- URL键值拼接过程value部分需要URL编码

- 签名有效期5分钟，需要请求接口时刻实时计算签名信息

- 更多注意事项，请查看常见问题

**3. 参考代码(PHP)**

以下是使用PHP实现的签名算法代码，开发者可以参考实现其他语言的版本。

::

    // getReqSign ：根据 接口请求参数 和 应用密钥 计算 请求签名
    // 参数说明
    //   - $params：接口请求参数（特别注意：不同的接口，参数对一般不一样，请以具体接口要求为准）
    //   - $appkey：应用密钥
    // 返回数据
    //   - 签名结果
    function getReqSign($params /* 关联数组 */, $appkey /* 字符串*/)
    {
        // 1. 字典升序排序
        ksort($params);

        // 2. 拼按URL键值对
        $str = '';
        foreach ($params as $key => $value)
        {
            if ($value !== '')
            {
                $str .= $key . '=' . urlencode($value) . '&';
            }
        }

        // 3. 拼接app_key
        $str .= 'app_key=' . $appkey;

        // 4. MD5运算+转换大写，得到请求签名
        $sign = strtoupper(md5($str));
        return $sign;
    }

**接口调用实示例**
^^^^^^^^^^^^^^^^^^^

本示例仅供开发者参考，学习如何生成签名以及调用API。

**1. 示例数据**

假设接口请求参数如下，应用密钥为：a95eceb1ac8c24ee28b70f7dbba912bf，其中sign参数用于存储接口请求签名。